<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tunnel Vision</title>
<link rel = "stylesheet" href="css/styles.css">
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<link rel = "stylesheet" href="css/editCurrSprint.css">
<link rel="stylesheet" href="css/profilePicturestyling.css">
<link rel="stylesheet" href="css/contrast.css">

<style>

html, body {
  margin: 0;
  padding: 0;
  background-color: #2c2c54;
  height: 100%;
}

.tunnel-vision-container {
  background-color: #2c2c54;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 0 0 129px;
  overflow: hidden;
  width: 100%;
}

.header-container {
  background-color: #2c2c54;
  display: flex;
  width: 100%;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
  gap: 10px;
}

.menu {
  position: absolute;
  left: 30px;
  display: flex;
  flex-direction: column;
  gap: 9px;
  margin-top: 23px;
}

.menu-button-line {
  border-radius: 46px;
  background-color: #2c2c54;
  width: 98px;
  height: 14px;
  border: 2px solid #f5e6e8;
  cursor: pointer;
}

.tunnel-vision-title {
  color: #f5e6e8;
  font: 600 64px Inter, sans-serif;
  text-align: center;
}

.page-title {
  color: #f5e6e8;
  text-align: center;
  margin-top: 46px;
  font: 800 48px Inter, sans-serif;
}

.sprints-container {
  width: 100%;
  max-width: 1272px;
  display: flex;
  gap: 20px;
}

.sprints-column {
  display: flex;
  flex-direction: column;
  flex: 1;
  width: 400px;
}

.future-sprints-section,
.in-progress-sprints-section,
.completed-sprints-section {
  border-radius: 10px;
  background-color: #8D99AE;
  padding: 14px;
  display: flex;
  flex-direction: column;
  color: black;
  font: 700 12px Inter, sans-serif;
}

.sprint-title {
  font-size: 24px;
  text-align: center;
}

.sprint-card {
  border-radius: 10px;
  background-color: white;
  padding: 12px 17px;
  color: black;
  margin-bottom: 23px;
  border: 1px solid black;
}

.sprint-name {
  font-size: 16px;
  margin-bottom: 8px;
}

.sprint-line-thing {
  margin: 8px 0;
  border: 2px solid black
}



.expand-sprint {
  font-size: 11px;
  text-align: right;
  margin-top: 9px;
  cursor: pointer;
}

.invisible {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0,0,0,0);
  white-space: nowrap;
  border: 0;
}

@media (max-width: 991px) {
  .tunnel-vision-container {
    padding-bottom: 100px;
  }

  .header-container {
    padding: 0 20px;
  }

  .tunnel-vision-title {
    font-size: 40px;
  }

  .page-title {
    margin-top: 40px;
    font-size: 40px;
  }

  .sprints-container {
    flex-direction: column;
    margin-bottom: 10px;
  }

  .sprint {
    padding-bottom: 100px;
  }
}

.logo-image {
  width: 7%;
  height: auto;
}


/*
Add Sprint screen popup
*/
body {
    font-family: Arial, sans-serif;
}

/* The Modal (background) */
.sprint-modal {
    display: none; 
    position: fixed; 
    z-index: 1; 
    left: 0;
    top: 0;
    width: 100%; 
    height: 100%; 
    background-color: rgba(0,0,0,0.5); 
}

/* Modal Content/Box */
.sprint-modal-content {
    background-color: white;
    position: absolute;
    top: 50%; 
    left: 50%; 
    transform: translate(-50%, -50%); /* Center the modal */
    padding: 20px;
    border: 1px solid #888;
    border-radius: 10px;
    width: 900px; /* Adjust the width (wider) */
    max-height: 800px; /* Adjust the height (reduce it) */
    overflow-y: auto; 
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);

}

label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

input[type="text"],
input[type="date"] {
    width: 100%;
    padding: 8px;
    margin-bottom: 20px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

#submit-sprint-btn {
    padding: 10px 15px;
    background-color: #28a745;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}


/* Close button for the modal */
#close-add-sprint-modal {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

#close-add-sprint-modal:hover,
#close-add-sprint-modal:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}

.sidebar {
    display: flex;
    flex-direction: column;
    height: 100vh;
    justify-content: space-between;
}

#menu-links {
    flex-grow: 1;
}

.bottom-link {
    display: flex;
    align-items: center; /* Vertically centers the image and text */
    justify-content: flex-start; 
    margin-bottom: 50px;
    text-align: center;
}

.bottom-link img {
    width: 150px; /* Adjust width as necessary */
    height: 150px; /* Adjust height as necessary */
    border-radius: 50%; /* Makes the image round */
    margin-left: -25px;
}

.bottom-link span {
    color: #2c2c54; /* Change text color if needed */
    font-size: 24px; /* Adjust font size as necessary */
    margin-left: -15px;
}

.button {
  border-radius: 64px;
  padding: 31px 69px;
  cursor: pointer;
  font: 300 20px Inter, sans-serif;
  border: 2px solid #f5e6e8;
  color: #fff
}


</style>
<body>



<section class="tunnel-vision-container">
    <nav class="menu" aria-label="Navigation">
    <label class="hamburger-menu">
        <input type="checkbox" id="menu-toggle">
    </label>
    <aside class="sidebar">
        <nav id="menu-links">
            <br><br>
            <header class="hamburger-page-button"><a href="index.html">Home</a></header><br>
            <header class="hamburger-page-button"><a href="sprint_page.html" style="text-decoration: underline; font-weight: bold;">All Sprints</a></header><br>
            <header class="hamburger-page-button"><a href="product_backlog_page.html">Product Backlog</a></header><br>
            <header class="hamburger-page-button"><a href="reports_page.html">Reports</a></header><br>
            <header class="hamburger-page-button"><a href="team_page.html">Team</a></header><br>
            <!-- New Sign Out button at the bottom -->
            <header class="hamburger-page-button"><a href="login_page.html">Sign Out</a></header><br>
        </nav>
        <!-- Add the bottom link here -->
        <footer class="hamburger-page-button bottom-link">
            <img src="Images/default-profile-pic-2.png" alt="Profile Picture">
            <span id="profile-name"class="profile-name"></span>
        </footer>              
    </aside>
</nav>




  <div class="blur-container">
  <header class="header-container">
    <img src="Images/Logo_rose.png" class="logo-image">
    <h1 class="tunnel-vision-title">Tunnel Vision</h1>
    <button id="toggle-contrast" class="button high-contrast-btn" style="width: 100px; padding: 5px 10px; font-size: 14px; cursor: pointer; background-color: orangered;">High Contrast Mode</button>
  </header>


  <h2 class="page-title">All Sprints</h2>

  <img src="Images/add_button.png" id="add-sprint-btn" style="width: 75px; height: 75px; cursor: pointer;"></img>





  <div class="sprints-container">

    <div class="sprints-column" id="sprint-future">
      <section class="future-sprints-section">
        <h3 class="sprint-title">Not Started</h3>

      </section>
    </div>

    <div class="sprints-column" id="sprint-in-progress">
      <section class="in-progress-sprints-section">
        <h3 class="sprint-title">In Progress Sprints</h3>

      </section>
    </div>

    <div class="sprints-column" id="sprint-completed">
      <section class="completed-sprints-section">
        <h3 class="sprint-title">Completed Sprints</h3>
      </section>
    </div>
  </div>




  <!-- The Modal -->
  <div id="add-sprint-modal" class="sprint-modal">

    <!-- Modal content -->
    <div class="sprint-modal-content" style="background-color: white;">
        <span class="close-add-sprint-modal" style="float: right; cursor: pointer; font-size: 32px; color: black;">&times;</span><br>
        
        <form>
            <label for="sprint-title">Title</label>
            <input type="text" id="sprint-title" style="width: 100%; 
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid black; 
            border-radius: 5px; 
            background-color:white;
            box-sizing: border-box;"
            name="sprint-title" required>

            <label for="sprint-desc">Description</label>
            <input type="text" id="sprint-desc" style="width: 100%; 
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid black; 
            border-radius: 5px; 
            background-color:white;
            box-sizing: border-box;"
            name="sprint-desc" required>

            <label for="start-date">Start Date</label>
            <input type="date" id="start-date" style="width: 100%; 
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid black; 
            border-radius: 5px; 
            background-color:white;
            box-sizing: border-box;"
            name="start-date" required>

            <label for="end-date">End Date</label>
            <input type="date" id="end-date" style="width: 100%; 
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid black; 
            border-radius: 5px; 
            background-color:white;
            box-sizing: border-box;"
            name="end-date" required>

            <div id="assignee-selection-container">
              <label for="assignee">Select Assignees</label>
              <div id="assignee-list" style="margin-bottom: 20px;"></div>
            </div>




            <label>Proxy Product Owner</label>
            <select id="product-owner-dropdown" style="width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid black;
            border-radius: 5px;
            background-color:white;
            box-sizing: border-box;">
                <option value=""></option>
            </select>

            <label>Scrum Master</label>
            <select id="scrum-master-dropdown" style="width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid black;
            border-radius: 5px;
            background-color:white;
            box-sizing: border-box;">
                <option value="">Select Scrum Master</option>
            </select>

           
            <select id="developers-dropdown" multiple style="width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid black;
            border-radius: 5px;
            background-color:white;
            box-sizing: border-box; display: none;">
                <option value="">Select Developer(s)</option>
            </select> 

            <div id="task-selection-container"> 
            

            </div><br>
        </form>
        
        <button type="button" id="submit-sprint-btn" style="background-color: #2c2c54;">Add Sprint</button>
    </div>
  </div>


  <div id="curr-sprints-popup" class="curr-sprint-popup-container">
    <button id="close-curr-sprints-btn" style="display: none;">&times;</button>
    <div id="sprint-details-container" class="sprint-details-container" style="background-color: white; width: 70%;">
       
    </div>
  </div>












</div>
</section>
<script>
  document.getElementById('toggle-contrast').addEventListener('click', function() {
  document.body.classList.toggle('high-contrast');

  var addButton = document.getElementById('add-sprint-btn');
    
    // Check if high contrast is on, and change the image accordingly
    if (document.body.classList.contains('high-contrast')) {
        addButton.src = 'Images/add_button_high_contrast.png'; // High contrast image
    } else {
        addButton.src = 'Images/add_button.png'; // Default image
    }

    // Get the logo image element
    var logoImage = document.querySelector('.logo-image');

    // Check if high contrast is on, and change the logo accordingly
    if (document.body.classList.contains('high-contrast')) {
        logoImage.src = 'Images/Logo_high_contrast.png'; // High contrast logo
    } else {
        logoImage.src = 'Images/Logo_rose.png'; // Default logo
    }
  });

</script>

<script type="module" src="https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js"></script>
<script type="module" src="https://www.gstatic.com/firebasejs/10.3.1/firebase-auth.js"></script>
<script type="module" src="https://www.gstatic.com/firebasejs/10.3.1/firebase-database.js"></script>

<script type="module" src="js/sprints.js"></script>

<script>
  // Get the checkbox and blur-container elements
  const menuToggle = document.getElementById('menu-toggle');
  const blurContainer = document.querySelector('.blur-container');

  // Event listener for the checkbox
  menuToggle.addEventListener('change', function() {
    // Toggle the blurred class on the blur-container
    if (menuToggle.checked) {
      blurContainer.classList.add('blurred');
    } else {
      blurContainer.classList.remove('blurred');
    }
  });
</script>
<script type="module" src="js/user-profile.js"></script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js";
  import { getDatabase, ref, set, push, get } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-database.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-auth.js";

  //The firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAg4NXpv6dHmmNqc-wAmJt4utArIpb9TbE",
    authDomain: "tunnelvision-f07f7.firebaseapp.com",
    databaseURL: "https://tunnelvision-f07f7-default-rtdb.firebaseio.com",
    projectId: "tunnelvision-f07f7",
    storageBucket: "tunnelvision-f07f7.appspot.com",
    messagingSenderId: "779720304073",
    appId: "1:779720304073:web:4e1e9e3cf3f1ecd337f418"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const database = getDatabase(app);

  function checkUserRole() {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    const userId = user.uid;
                    const userRef = ref(database, 'user-accounts/' + userId);

                    get(userRef).then((snapshot) => {
                        const data = snapshot.val();
                        if (data.isAdmin) {
                            addAdminLink();
                        }
                    });
                }
            })
        }

    function addAdminLink() {
      const menuLinks = document.getElementById('menu-links');
  
      // Add a <br> for spacing
      const lineBreak = document.createElement('br');
      menuLinks.appendChild(lineBreak);
  
      // Create the "Create Account" link
      const adminLink = document.createElement('header');
      adminLink.classList.add('hamburger-page-button');
      adminLink.innerHTML = '<a href="account_creation.html">Create Account</a>';
  
      // Append the "Create Account" link after the "Team" link
      const teamLink = menuLinks.querySelectorAll('header.hamburger-page-button')[4]; 
      teamLink.insertAdjacentElement('afterend', lineBreak);
      lineBreak.insertAdjacentElement('afterend', adminLink);
  }
      


  document.addEventListener('DOMContentLoaded', function() {
    checkUserRole();
  });

</script>
<script type="module" src="js/activateSprint.js"></script>

</body>
</html>